@model IEnumerable<TashiOTS.Models.LevelModel>

@{ Html.RenderPartial("_SettingsMenu"); }
<style type="text/css">
    button.myClose {
        /*background: #ff9b44;
    background: -moz-linear-gradient(left, #ff9b44 0%, #fc6075 100%);
    background: -webkit-gradient(left top, right top, color-stop(0%, #ff9b44), color-stop(100%, #fc6075));
    background: -webkit-linear-gradient(left, #ff9b44 0%, #fc6075 100%);
    background: -o-linear-gradient(left, #ff9b44 0%, #fc6075 100%);
    background: -ms-linear-gradient(left, #ff9b44 0%, #fc6075 100%);*/
        background: linear-gradient(to right, #ff9b44 0%, #fc6075 100%);
        border-radius: 50%;
        height: 37px;
        left: -15px;
        opacity: 1;
        position: relative;
        top: 15px;
        width: 37px;
        text-shadow: inherit;
        color: #fff;
        z-index: 99;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        $('a[href$="' + "/hierarchy" + '"]').closest("li").addClass('active');
        var i = 0, j = 0, k = 0;
        currentRow = null;
        $('#btn_save').hide();
        GetHierarchy();
        $('#tblhierarchyList').hide();
        $('#btn_updateHierarchy').hide();
        $('#div_employee').hide();
        //$(document).on('click', '.EbtnEdit', function (e) {
        //    var hierarchy_id = $(this).closest('tr td a').attr('data_id');
        //    if (hierarchy_id != "")
        //    {
        //        $.ajax({
        //            type: 'POST',
        //            url: '/settings/GetHierarchyById',
        //            contentType: 'application/json;charset=utf-8',
        //            data: JSON.stringify({ 'hierarchy_id': hierarchy_id }),
        //            dataType: 'json',
        //            success: function (data) {
        //                var len = Object.keys(data).length;
        //                if (len > 0)
        //                {
        //                    $('#ddl_level').val(data[0].hierarchy_level);
        //                    $('#ddl_value').val(data[0].hierarchy_value);
        //                    $('#ddl_status').val(data[0].status);                           
        //                    $('#hdn_hierarchyId').val(data[0].hierarchy_id);
        //                    $('#btn_addHierarchy').hide();
        //                    $('#btn_updateHierarchy').show();
        //                }
        //            },
        //            error: function (data) {
        //                alert(data.responseText);
        //            }
        //        });
        //    }           
        //});
        $('#btn_addHierarchy').click(function () {
            var hierarchy_name = $('#txt_hierarchyname').val();
            var hierarchy_level = $('#ddl_level option:selected').val();       
            var hierarchy_valueId;
            var hierarchy_value;
            if ($("#ddl_level").val() == 'SU' || $("#ddl_level").val() == 'Auto') {
                hierarchy_valueId = $('#ddl_employee option:selected').val();
                hierarchy_value = $('#ddl_employee option:selected').text();
            } else {
                var hierarchy_valueId = $('#ddl_value option:selected').val();
                var hierarchy_value = $('#ddl_value option:selected').text();
            }          
            var status = $('#ddl_status option:selected').text();
            var status_id = $('#ddl_status option:selected').val();
            //var end_date = $('#txt_enddate').val();

            if ($("#ddl_value").val() == "MM" || $("#ddl_value").val() == "HR" || $("#ddl_value").val() == "FH") {
              
                if ($("#ddl_employee option:selected").text() == "Select") {
                    alert("Please Select  Employee !");
                    $("#ddl_employee").focus();
                    return false;

                }

            }

            if ($("#txt_startdate").val() == "") {
                alert("Start Date Can't be blank !");
                $("#txt_startdate").focus();
                return false;
            }
            if ($("#txt_enddate").val() == "") {
                alert("End Date Can't be blank !");
                $("#txt_enddate").focus();
                return false;
            }

        
            if (hierarchy_name != "" && hierarchy_level != "" &&  $('#ddl_value').val()!="")
            {
                //$.ajax({
                //    type: 'POST',
                //    url: '/settings/save_hierarchy',
                //    contentType: 'application/json;charset=utf-8',
                //    data: JSON.stringify({ 'hierarchy_name': hierarchy_name, 'hierarchy_level': hierarchy_level, 'hierarchy_value': hierarchy_value }),
                //    dataType: 'json',
                //    success: function (data) {
                //        debugger;
                //        var succ = data.success_msg;
                //        var err = data.error_msg;
                //        if (data != null && succ != null)
                //        {
                //            alert(succ);
                //            $('#txt_hierarchyname').prop('readonly', true);
                //            $('#ddl_level').val("");
                //            $('#ddl_value').val("");
                //            GetHierarchyByName(hierarchy_name);
                //        }
                //        else {
                //            alert(err);
                //        }
                //    },
                //    error: function (data) {
                //        alert(data.responseText);
                //    }
                //});
                
               var html = '';
               var sr_no = "";
               if (currentRow) {
                   sr_no=$('#Edithdn_hierarchyCount').val();
               }
               else {
                   
                   sr_no = $('#hdn_hierarchyCount').val();
               }

                html += "<tr id='row" + i + "'>";
                html += "<td>" + sr_no + "</td>";
                html += "<td style='display: none;'>" + hierarchy_name + "</td>";
                html += "<td data_id='" + hierarchy_level + "'>" + $('#ddl_level option:selected').text() + "</td>";
                html += "<td data_id='" + hierarchy_valueId + "'>" + hierarchy_value + "</td>";
                if ($("#ddl_value").val() == 'MM' || $("#ddl_value").val() == 'HR' || $("#ddl_value").val() == 'FH') {
                    html += "<td data_id='" + $("#ddl_employee").val() + "'>" + $("#ddl_employee option:selected").text() + "</td>";
                } else {
                    html += "<td data_id=''></td>";
                }
                html += "<td>" + $("#txt_startdate").val()+"</td>";
                html += "<td>" + $("#txt_enddate").val() + "</td>";
                html += "<td data_id='" + status_id + "'>" + status + "</td>";
                //html += "<td>" + end_date + "</td>";
                if ($('#hdn_hierarchyId').val()>0) {
                    html += "<td><a href='javascript:void(0);' class='font-18 btnEdit' data_id='" + $('#hdn_hierarchyId').val()+"' title='Edit' id='btn_edit'><i class='fa fa-pencil m-r-5'></i></a> ";
                } else {
                    html += "<td><a href='javascript:void(0);' class='font-18 btnEdit'  data_id='0' title='Edit' id='btn_edit'><i class='fa fa-pencil m-r-5'></i></a> <a href='javascript:void(0)' class='text-danger font-18 btnDelete' title='Remove' ><i class='fa fa-trash-o' aria-hidden='true'></i></a>";
                }
                $('#hdn_hierarchyId').val(0);
                html += "</tr>";

                if (currentRow) {

                    var table = $("#tblhierarchyList tbody").find('tr')
                    var Boolean = false;
                    table.each(function () {
                        if ($(this).find('td')) {
                            if ($('#hdtblcurrenthierarchyvalue').val() != $("#ddl_value").val()) {
                                if ($(this).find("td").eq(3).attr('data_id') == $("#ddl_value").val()) {
                                    Boolean = true;
                                }
                            }
                            
                        }

                    });
                    if (Boolean == true) {
                        alert("Please Select Unique  Value !");
                        $('#ddl_value').focus("");
                        setTimeout(function () { $('#ddl_value').focus(); });
                        return false;
                    }

                    $("#tblhierarchyList tbody").find($(currentRow)).replaceWith(html);
                    currentRow = null;
                    alert("Successfully updated row.")
                    $("#btn_addHierarchy").html('Add');  
                    $('#ddl_level').val("0");
                    $('#ddl_value').val("");
                    $("#ddl_employee option:contains(Select)").attr("selected", true); 
                    $("#div_employee").hide();
                    $("#div_value").show(); 
                    $('#ddl_status').val("Active"); 
                    hd_sartdate

                    $("#txt_startdate").val("");
                    $("#txt_enddate").val("");
                   // hd_sartdate
                    $("#txt_startdate").prop("disabled", true).css('background-color', '#eee');
                    $("#txt_enddate").prop("disabled", true).css('background-color', '#eee');
                    
                }
                else
                {
                    $("#hd_sartdate").val($("#hd_sartdate").val());
                    $("#hd_enddate").val($("#txt_enddate").val());
                    //if (parseInt($("#hdlavelcondition").val()) == 4) {
                    //    alert("You create three level at a time  !");
                    //    return false;
                    //} else if ($("#hdlavelcondition").val() != $("#ddl_level").val()) {
                    //    alert("Please Select Level " + $("#hdlavelcondition").val() + " !");
                    //    setTimeout(function () { $('#ddl_level').focus(); });
                    //    return false;
                    //}  

                    var table = $("#tblhierarchyList tbody").find('tr')
                    var Boolean = false;
                    table.each(function () {
                        if ($(this).find('td')) {

                            if ($(this).find("td").eq(3).attr('data_id') == $("#ddl_value").val()) {
                                Boolean = true;
                            } 
                        }

                    });
                    if (Boolean == true) {
                        alert("Please Select Unique  Value !");
                        $('#ddl_value').focus("");
                        setTimeout(function () { $('#ddl_value').focus(); });
                        return false;
                    }

                    $("#tblhierarchyList").find("tbody").append(html);
                   
                    $("#hdlavelcondition").val(parseInt($("#hdlavelcondition").val()) + 1);
                    alert("Successfully added row.");
                    $('#tblhierarchyList').show();                    
                    var increment_count = parseInt(parseInt(sr_no) + 1);
                    $('#hdn_hierarchyCount').val(increment_count);
                    $('#txt_hierarchyname').prop('readonly', true);
                    $('#ddl_level').val("0");
                    $('#ddl_value').val(""); 
                    $("#ddl_employee option:contains(Select)").attr("selected", true); 
                    $('#btn_save').show();
                    $("#div_employee").hide();
                    $("#div_value").show();  
                    $('#ddl_status').val("Active");
                    $("#txt_startdate").val("");
                    $("#txt_enddate").val("");
                    $("#txt_startdate").prop("disabled", true).css('background-color', '#eee');
                    $("#txt_enddate").prop("disabled", true).css('background-color', '#eee');


                    i = i + 1;
                }    
            }
            else if (hierarchy_name=="")
            {
                alert("Hierarchy name can't be blank.");
                setTimeout(function () { $('#txt_hierarchyname').focus(); });
            }
            else if (hierarchy_level != "Select")
            {
                alert("Hierarchy Level can't be blank.");
                setTimeout(function () { $('#ddl_level').focus(); });
            }
           
            else {
                alert("Hierarchy value can't be blank.");
                setTimeout(function () { $('#ddl_value').focus(); });
            }
        }); 
        $(document).on("click", ".btnDelete", function (event) {
            event.preventDefault();
            var table = 'tblhierarchyList';
            var row = $(this).closest('tr');
            var id = row.attr("id"); 
            if (_functiondelete() == true) {
                setTimeout(function () { // Simulating ajax
                    var siblings = row.siblings();
                    row.remove();
                    siblings.each(function (index) {
                        index = index + 1;
                        $(this).children().first().text(index);
                    });
                }, 100);
            }
        });

        $(document).on('click', '.btnEdit', function (e) {
          
            currentRow = $(this).parents('tr');
            $('#hdn_hierarchyId').val($(this).closest('tr td a').attr('data_id'));
            $('#Edithdn_hierarchyCount').val($(this).closest('tr').find('td').eq(0).html());
            $('#hdtblcurrenthierarchyvalue').val($(this).closest('tr').find('td').eq(3).attr('data_id'));
            $("#ddl_value").val($(this).closest('tr').find('td').eq(3).attr('data_id'));

            if ($(this).closest('tr').find('td').eq(3).attr('data_id') == 'MM' || $(this).closest('tr').find('td').eq(3).attr('data_id') == 'HR' || $(this).closest('tr').find('td').eq(3).attr('data_id') == 'FH') {
               // $("#div_value").hide(); 
                $("#div_employee").show();  
                $("#ddl_employee").val($(this).closest('tr').find('td').eq(4).attr('data_id'));
              
            } else
            {
                $("#div_employee").hide();  
               // $("#div_value").show();  
                $("#ddl_employee").val(""); 
                
            }
            $("#ddl_level").val($(this).closest('tr').find('td').eq(2).attr('data_id'));
            $("#txt_startdate").val($(this).closest('tr').find('td').eq(5).html());
            $("#txt_enddate").val($(this).closest('tr').find('td').eq(6).html());
            $("#ddl_status").val($(this).closest('tr').find('td').eq(7).attr('data_id'));

            $("#txt_startdate").prop("disabled", false).css('background-color', '#ffffff');
            $("#txt_enddate").prop("disabled", false).css('background-color', '#ffffff');
            $("#btn_addHierarchy").text('Update');

        });
        $(document).on('click', '#btn_edit', function (e) {
            var hierarchy_name = $(this).closest('tr td a').attr('data_id');
            GetHierarchyByName(hierarchy_name);
        });
        $('#btn_add').click(function () { 

            $("#hd_sartdate").val('');
            $("#hd_enddate").val('');
            currentRow = null; 
            $("#btn_addHierarchy").html('Add');
            $('#ddl_level').val("0");
            $('#ddl_value').val("");
            $("#ddl_employee").val("");
            $("#div_employee").hide();
            $("#div_value").show();
            $('#ddl_status').val("Active");
            $("#txt_startdate").val("");
            $("#txt_enddate").val("");
            $("#btn_save").hide(); 
            $("#btn_addHierarchy").text("Add"); 
            $("#hdlavelcondition").val(1); 

            $('#hdn_hierarchyCount').val("1");
            $('#Edithdn_hierarchyCount').val("0");
            $('#tblhierarchyList tbody').empty();
            $('#tblhierarchyList').hide();
            $('#add_hierarchy').modal('hide');
            $('#add_hierarchy').modal('show');
        });
        $('#btn_Close').click(function () {
            GetHierarchy();
            $('#txt_hierarchyname').val("").prop('readonly', false);
            $('#ddl_level').val("0");
            $('#ddl_value').val("");
            $('#hdn_hierarchyCount').val("1");
            $('#Edithdn_hierarchyCount').val("0");
            $('#tblhierarchyList tbody').empty();
            $('#tblhierarchyList').hide();
            $('#add_hierarchy').modal('hide');


            $("#btn_addHierarchy").html('Add');
            $('#ddl_level').val("0");
            $('#ddl_value').val("");
            $("#ddl_employee").val("");
            $("#div_employee").hide();
            $("#div_value").show();
            $('#ddl_status').val("Active");
            $("#txt_startdate").val("");
            $("#txt_enddate").val("");
            $("#btn_save").hide();
            $("#btn_addHierarchy").text("Add");
            $("#hdlavelcondition").val(1);
        });
        $('#btn_save').on('click', function (e) {
            var count = 1, boolean = true; 
            var max_row = 1;
            var table = $("#tblhierarchyList tbody").find('tr');
            max_row = table.length;
      
            var max_label = ""; 
            table.each(function () {
                if ($(this).find('td')) {
                    //if ($(this).find("td").eq(2).attr('data_id') != 'NA') {
                    //   // if ($(this).find("td").eq(2).attr('data_id') != count){
                    //    if ($(this).find("td").eq(2).attr('data_id') != count) {
                    //     //   alert("You Have To Maintain  Sequence In Level !"); 
                    //        boolean = false;
                    //        return false;
                    //    } else {
                    //        count = count + 1;
                    //    } 
                    //}

                    if (max_label == "") {
                        max_label = $(this).find("td").eq(2).attr('data_id');
                    } else {
                        if ($(this).find("td").eq(2).attr('data_id') > max_label) {
                            max_label = $(this).find("td").eq(2).attr('data_id');
                        }
                    }

                }
            });
            if (max_label != max_row) {
                alert("You Have To Maintain  Sequence In Level !");
                return false;
            }

            alert(1);
            return false;

            if (boolean == true) { 
                var data = JSON.stringify(GetTableData());
                if (Object.keys(data).length > 2) {
                    $.ajax({
                        url: '/settings/save_hierarchy',
                        type: 'POST',
                        contentType: "application/json;charset=utf-8",
                        data: JSON.stringify
                            ({
                                'TableData': data
                            }),
                        dataType: 'json',
                        success: function (data) {
                            var succ = data.success_msg;
                            var err = data.error_msg;
                            if (data != null && succ != null) {
                                alert(succ);
                                $('#txt_hierarchyname').val("").prop('readonly', false);
                                $('#ddl_level').val("0");
                                $('#ddl_value').val("");
                                $("#tblhierarchyList tbody").empty();
                                $('#btn_save').hide();
                                GetHierarchy();
                                $('#tblhierarchyList').hide();
                                $('#add_hierarchy').modal('hide');
                            }
                            else {
                                alert(err);
                            }
                        },
                        error: function () {
                            alert("Network Related Error");
                        }
                    });
                }
            }
        });
        //$('#btn_updateHierarchy').click(function () {
        //    var hierarchy_id = $('#hdn_hierarchyId').val();
        //    var hierarchy_name = $('#txt_hierarchyname').val();
        //    var hierarchy_level = $('#ddl_level option:selected').val();
        //    var hierarchy_value = $('#ddl_value option:selected').val();
        //    var status = $('#ddl_status option:selected').val();
        //    if (hierarchy_id != "" && hierarchy_level != "" && hierarchy_value!= "")
        //    {
        //        $.ajax({
        //            type: 'POST',
        //            url: '/settings/UpdateHierarchyById',
        //            contentType: 'application/json;charset=utf-8',
        //            data: JSON.stringify({ 'hierarchy_id': hierarchy_id, 'hierarchy_level': hierarchy_level, 'hierarchy_value': hierarchy_value, 'status': status }),
        //            dataType: 'json',
        //            success: function (data) {
        //                var succ = data.success_msg;
        //                var err = data.error_msg;
        //                if (succ != null)
        //                {
        //                    alert(succ);
        //                    GetHierarchyByName(hierarchy_name);
        //                    $('#hdn_hierarchyId').val("0");
        //                    $('#ddl_level').val("0");
        //                    $('#ddl_value').val("");
        //                    $('#ddl_status').val("Active");
        //                    $('#btn_addHierarchy').show();
        //                    $('#btn_updateHierarchy').hide();
        //                }
        //                else {
        //                    alert(err);
        //                }
        //            },
        //            error: function (data) {
        //                alert(data.responseText);
        //            }
        //        });
        //    }
        //    else if (hierarchy_level != "") {
        //        alert("Hierarchy Level can't be blank.");
        //        setTimeout(function () { $('#ddl_level').focus(); });
        //    }
        //    else {
        //        alert("Hierarchy value can't be blank.");
        //        setTimeout(function () { $('#ddl_value').focus(); });
        //    }

        //});
        $('.myClose').click(function () {
            window.location.href = "/settings/approval_rules";
        });

        $.ajax({
                type: 'POST',
                url: '/settings/BindEmployee',
                contentType: 'application/json;charset=utf-8',
                data: {},
                dataType: 'json',
                success: function (data) {
                    if (data != null) {
                        var len = Object.keys(data).length;
                        $("#ddl_employee").html("");
                        $("#ddl_employee").append($('<option></option>').html("Select"));
                        //Append each row to dropdown
                        for (var i = 0; i < len; i++) {
                            $("#ddl_employee").append($('<option></option>').val(data[i].emp_id).html(data[i].emp_name));
                        }
                       // $("#div_employee").show();
                    }
                    else {
                        alert('no data found.');
                    }
                },
                error: function (data) {
                    alert(data.responseText);
                }
        });
        $("#txt_startdate").on("change", function () { 
                $('#txt_enddate').val(""); 
        });
        $("#txt_enddate").on("change", function () {
            var start_dt = myDateFormatter($('#txt_startdate').val());
            var end_dt = myDateFormatter($('#txt_enddate').val());
            if (start_dt > end_dt) {
                alert("End Date can't less then start date.");
                $('#txt_enddate').val("");
                setTimeout(function () { $('#txt_enddate').focus(); })
            }
        });

       

    });
    function GetHierarchy() { 
       
        $.ajax({
            type: 'POST',
            url: '/settings/GetHierarchy',
            contentType: 'application/json;charset=utf-8',
            data: {},
            dataType: 'json',
            success: function (data) {
                var len = Object.keys(data).length;
                if (len > 0) {
                    $('#tbl_hierarchy tbody').empty();
                    var html = '';
                    for (var i = 0; i < len; i++) {
                        html += "<tr>";
                        html += "<td>" + data[i].sr_no + "</td>";
                        html += "<td>" + data[i].hierarchy_name + "</td>";
                        html += "<td><a href='javascript:void(0);' title='Edit' id='btn_edit' data_id='" + data[i].hierarchy_name + "'><i class='fa fa-pencil m-r-5'></i></a>";
                        //html += "<a href='javascript:void(0);' title='Delete' id='btn_del' data_id='" + data[i].hierarchy_name + "'><i class='fa fa-trash m-r-5'></i></a>";
                        html += "</td>";
                        html += "</tr>";
                    }
                    $('#tbl_hierarchy tbody').append(html);
                }
            },
            error: function (data) {
                alert(data.responseText);
            }
        });
    }
    function GetHierarchyByName(hierarchy_name)
    {

         

        $.ajax({
            type: 'POST',
            url: '/settings/GetHierarchyByName',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify({ 'hierarchy_name': hierarchy_name}),
            dataType: 'json',
            success: function (data)
            {
                var len = Object.keys(data).length;
                if (len > 0)
                {
                    $("#tblhierarchyList tbody").empty(); 
                    var html = '';

                    for (var i = 0; i < len; i++)
                    {
                
                        html += "<tr id=''>";
                        html += "<td>" + data[i].sr_no + "</td>";
                        html += "<td style='display: none;'>" + data[i].hierarchy_name + "</td>";
                        html += "<td data_id=" + data[i].hierarchy_level_attr+">" + data[i].hierarchy_level + "</td>";
                        html += "<td  data_id=" + data[i].hierarchy_value_attr + ">" + data[i].hierarchy_value + "</td>";
                        html += "<td  data_id=" + data[i].emp_id + ">" + data[i].emp_name + "</td>";
                        html += "<td>" + data[i].startdate + "</td>";
                        html += "<td>" + data[i].enddate + "</td>";
                        html += "<td data_id=" + data[i].status + ">" + data[i].status + "</td>";
                        html += "<td><a href='javascript:void(0);' class='font-18 btnEdit' data_id='" + data[i].hierarchy_id + "' title='Edit' id='btn_edit'><i class='fa fa-pencil m-r-5'></i></a></td>";
                        html += "</tr>";
                        var sr = parseInt(parseInt(data[i].sr_no) + 1);
                        $('#hdn_hierarchyCount').val(sr);
                    }

                    $('#tblhierarchyList tbody').append(html);
                    $('#txt_hierarchyname').val(hierarchy_name).prop('readonly', true);
                    $('#tblhierarchyList').show();
                    $('#btn_save').show();                    
                    $('#add_hierarchy').modal('show');
                }
            },
            error: function (data) {
                alert(data.responseText);
            }
        });
    }
    function GetTableData()
    {
        var data = [];
        $('#tblhierarchyList tbody tr').each(function () {
            
            var hierarchy_id = $(this).find('td a').attr('data_id');
            var rowid = $(this).attr('id');
            var hierarchy_name = $(this).find("td").eq(1).html();
            var hierarchy_level = $(this).find("td").eq(2).attr('data_id');
            var hierarchy_value = $(this).find("td").eq(3).attr('data_id');
            var startdate = $(this).find("td").eq(5).html();
            var enddate = $(this).find("td").eq(6).html();            
            var employee_id = $(this).find("td").eq(4).attr('data_id') == "" ? 0 : $(this).find("td").eq(4).attr('data_id');
            var status = $(this).find("td").eq(7).html();
            if (rowid != "")
            {         
                var alldata = {
                    'hierarchy_id': hierarchy_id,
                    'hierarchy_name': hierarchy_name,
                    'hierarchy_level': hierarchy_level,
                    'hierarchy_value': hierarchy_value,
                    'startdate': startdate,
                    'enddate': enddate,
                    'employee_id': employee_id,
                    'status': status
                }
                data.push(alldata);
            }
        });
        return data;
    }
    function ValueOnChange(t)
    {
        if ($("#ddl_level").val() == 0) {
            alert("Please Select Level !");
            $("#ddl_value").val("");
            return false;
        }

        var value = $(t).val();       
        if (value == "MM" || value == "HR" || value == "FH") {
            //$.ajax({
            //    type: 'POST',
            //    url: '/settings/BindEmployee',
            //    contentType: 'application/json;charset=utf-8',
            //    data: {},
            //    dataType: 'json',
            //    success: function (data) {
            //        if (data != null) {
            //            var len = Object.keys(data).length;
            //            $("#ddl_employee").html("");
            //            $("#ddl_employee").append($('<option></option>').html("Select"));
            //            //Append each row to dropdown
            //            for (var i = 0; i < len; i++) {
            //                $("#ddl_employee").append($('<option></option>').val(data[i].emp_id).html(data[i].emp_name));
            //            }
            //            $("#div_employee").show();
            //        }
            //        else {
            //            alert('no data found.');
            //        }
            //    },
            //    error: function (data) {
            //        alert(data.responseText);
            //    }
            //});

            $("#div_employee").show();
        } else {
            $("#ddl_employee").prop('selectedIndex', 0);
            $("#div_employee").hide();
        }
    }
    function LevelOnChange(t)
    {
         
        $("#txt_startdate").val($("#hd_enddate").val());
        $("#txt_enddate").val($("#hd_enddate").val());


        $("#ddl_value").val("");
        var value = $(t).val();
        if (value == "SU" || value == "Auto") {
            $('#ddl_value').val("");
            $('#div_value').hide();
            $("#div_employee").show();
            $.ajax({
                type: 'POST',
                url: '/settings/BindEmployee',
                contentType: 'application/json;charset=utf-8',
                data: {},
                dataType: 'json',
                success: function (data) {
                    if (data != null) {
                        var len = Object.keys(data).length;
                        $("#ddl_employee").html("");
                        $("#ddl_employee").append($("<option value></option>").html("Select"));
                        //Append each row to dropdown
                        for (var i = 0; i < len; i++) {
                            $("#ddl_employee").append($('<option></option>').val(data[i].emp_id).html(data[i].emp_name));
                        }
                    
                    }
                    else {
                        alert('no data found.');
                    }
                },
                error: function (data) {
                    alert(data.responseText);
                }
            });
        }
        else {
            $('#div_value').show();
            $('#div_employee').hide();
        }
    }
    function ClearText()
    {
        $('#txt_hierarchyname').val("");
        $('#ddl_level').val("0");
        $('#ddl_value').val("");
        $('#ddl_employee').val("");
        $('#ddl_status').val('Active');

    }
    function _functiondelete() {
        if (confirm("Are you sure you want to delete record ?")) {
            return true;
        } else {
            return false;
        }
    }
</script>
<div class="row">
    <div class="col-sm-6">
        <h4 class="page-title">Hierarchy</h4>
    </div>
    <div class="col-sm-4 text-right m-b-30">
        <a href="javascript:void(0);" class="btn btn-primary rounded" id="btn_add"><i class="fa fa-plus"></i> Add New</a>
    </div>
    <div class="col-sm-2 text-right m-b-30">
        <button type="button" class="close myClose" style="display:none" id="btn_HierarchyClose">&times;</button>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div>
            <div class="row" id="hierarchy">
                <div class="col-md-12">
                    <table class="table table-striped custom-table m-b-0 " id="tbl_hierarchy">
                        <thead>
                            <tr>
                                <th>Sr. No.</th>
                                <th>Hierarchy Name</th>
                                <th width="60px" class="text-left">Action</th>
                            </tr>
                        </thead>
                        <tbody>                           
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="add_hierarchy" class="modal custom-modal fade" role="dialog">
    <div class="modal-dialog">
        <button type="button" class="close" id="btn_Close" data-dismiss="modal">&times;</button>
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h4 class="modal-title">Add Hierarchy</h4>
            </div>
            <div class="modal-body">
                <form>
                    
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label>Hierarchy Name <span class="text-danger">*</span></label>
                                    <input class="form-control" id="txt_hierarchyname" type="text" placeholder="Hierarchy Name">
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label>Level<span class="text-danger">*</span></label>
                                    <select class="form-control" id="ddl_level" onchange="LevelOnChange(this);">
                                        <option value="0">Select</option>
                                        <option value="1">Level 1</option>
                                        <option value="2">Level 2</option>
                                        <option value="3">Level 3</option>
                                        <option value="4">Level 4</option>
                                        <option value="5">Level 5</option>
                                        <option value="6">Level 6</option>
                                        @*<option value="7">Level 7</option>*@
                                        @*<option value="NA">Not Applicable</option>*@
                                        @*<option value="SU">Single User</option>
                                        <option value="Auto">Auto Approval</option>*@
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4" id="div_value">
                                <div class="form-group">
                                    <label>Value<span class="text-danger">*</span></label>
                                    <select class="form-control" id="ddl_value" onchange="ValueOnChange(this);">
                                        <option value="">Select</option>
                                        <option value="IS">Immediate Supervisor</option>
                                        <option value="SH">Section Head</option>
                                        <option value="DH">Department Head</option>
                                        <option value="MM">Management</option>
                                        <option value="HR">Human Resource</option>
                                        <option value="FH">Finance Head</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4" id="div_employee">
                                <div class="form-group">
                                    <label>Employee<span class="text-danger">*</span></label>
                                    @Html.DropDownList("ddl_employee",(IEnumerable<SelectListItem>)ViewBag.employee, new { @class = "form-control" })
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label>Start date<span class="text-danger">*</span></label>
                                    <div class="cal-icon "><input id="txt_startdate" placeholder="dd-mmm-yyyy" class="form-control mycal" type="text"></div> 
                                    <input type="hidden"    id="hd_sartdate" name="name" value="" />
                                </div>
                            </div>


                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label>End date<span class="text-danger">*</span></label>
                                    <div class="cal-icon "><input id="txt_enddate" placeholder="dd-mmm-yyyy" class="form-control mycal" type="text"></div>
                                    <input type="hidden" id="hd_enddate" name="name" value="" />
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label>Status<span class="text-danger">*</span></label>
                                    @*<div class="cal-icon "><input id="txt_startdate" class="form-control mycal" type="text"></div>*@
                                    <select id="ddl_status" class="form-control">
                                        <option selected value="Active">Active</option>
                                        <option value="In-active">In-active</option>
                                        @*<option value="Draft">Draft</option>*@
                                    </select>
                                </div>
                            </div>
                             <div class="col-sm-1">
                                <div class="form-group">
                                    <label></label>
                                </div>

                                 <input type="hidden" id="hdlavelcondition" value="1" />
                                 <input type="hidden" id="hdtblcurrenthierarchyvalue"  />
                                 <button type="button" class="btn btn-primary" style="margin-top:-10px;width:98px;" id="btn_addHierarchy">Add</button>
                                 <button type="button" class="btn btn-primary" style="margin-top:-10px;" id="btn_updateHierarchy">Update</button>
                                 <input type="hidden" id="hdn_hierarchyId" />
                            </div>
                        </div>                     
                    </div>     
                    <br />
                    <div class="row" id="tbl_hierarchyList">
                        <input type="hidden" id="hdn_hierarchyCount" value="1" />
                        <input type="hidden" id="Edithdn_hierarchyCount" value="0" />
                        <div class="col-md-12">
                            <table class="table table-striped custom-table m-b-0 " id="tblhierarchyList">
                                <thead>
                                    <tr>
                                        <th>Sr. No.</th>
                                        <th style="display:none;">Hierarchy Name</th>
                                        <th>Hierarchy Level</th>
                                        <th>Hierarchy Value</th>
                                        <th>Employee Name</th>
                                        <th>Start date</th>
                                        <th>End date</th>
                                        <th>Status</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                    <br />
                    <div class="row text-center">
                        <button class="btn btn-primary" id="btn_save" type="button">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
@*<div id="LevelModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
 
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Edit Hierarchy</h4>
            </div>
            <div class="modal-body" style="padding-left:20px">
                <div class="form-group">
                    <label>Level</label>
                    <select class="form-control" id="ddl_level">
                        <option value="">Select</option>
                        <option value="Level 1">Level 1</option>
                        <option value="Level 2">Level 2</option>
                        <option value="Level 3">Level 3</option>
                        <option value="Not Applicable">Not Applicable</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>value</label>
                    <input type="text" id="txt_value" class="form-control" readonly="readonly" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btn_save" class="btn btn-primary">Save</button>
                <input type="hidden" id="hdn_hierarchyId"/>
            </div>
        </div>

    </div>
</div>*@